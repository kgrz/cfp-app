.row
  .col-xs-12
    .heading.text-center
      %h2 Participants Details

.event-links.text-center
  .row
    .col-xs-8.col-xs-offset-2
      .row
        .col-sm-3.col-xs-12
          = link_to 'view speakers', organizer_event_speakers_path(event)
        .col-sm-4.col-xs-12
          = link_to 'Add/Invite New Participant', '#', data: { toggle: 'modal', target: "#new-participant-event-#{event.id}" }
        .col-sm-5.col-xs-12
          = link_to 'Manage Participant Invitations',
            organizer_event_participant_invitations_path(event)

.row
  .col-md-12
    %table.participants.table.table-striped
      %thead
        %tr
          %th Name
          %th Email
          %th Rated Proposals
          %th Role
          %th.notifications Comment Notifications
          %th.actions Actions
      %tbody
        - participants.each do |participant|
          %tr
            %td= participant.person.name
            %td= participant.person.email
            %td= rating_counts[participant.person.id] || 0
            %td= participant.role
            %td.notifications
              = participant.comment_notifications
              - if participant.person == current_user
                = render partial: 'organizer/events/participant_notifications', locals: {participant: participant}
            %td.actions
              - unless participant.person == current_user
                = render partial: 'organizer/events/participant_controls', locals: { participant: participant }

%div{ id: "new-participant-event-#{event.id}", class: 'modal fade' }
  .modal-dialog
    .modal-content
      = form_for event.participants.build, url: organizer_event_participants_path(event), html: {role: 'form', class: 'form'} do |f|
        .modal-header
          %h3 Add/Invite a participant to #{event.name}
        .modal-body
          .form-group-lg
            = label_tag :email
            = text_field_tag :email, '', class: 'form-control',
              id: 'autocomplete-email',
              placeholder: "Participant's email",
              data: { path: emails_organizer_event_participants_path(event) }
          .form-group-lg
            = f.label :role
            = f.select :role, ['reviewer', 'organizer'], {}, class: 'form-control'
        .modal-footer
          %button.btn.btn-default{'data-dismiss' => "modal"} Cancel
          %button.pull-right.btn.btn-success{:type => "submit"} Save

